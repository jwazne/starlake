---
sidebar_position: 50
title: Tests
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


## Metadata
All the information related to a project are stored in the metadata folder. This folder is organized as follows:

- metadata/extract: Is this sub where you write all extraction rules such as which tables and columns you want to extract from an existing database.
- metadata/load: this sub-directory contains all informations related to load jobs. A load job is a job that load files from disk, validate the input records and store them in the target datawarehouse 
- metadata/transform: this sub-directory contains all informations related to transform jobs. A transform job is a job that run against existing tables on the target database and write the result in a target table. These are usually jobs that compute KPIs by aggregating values from different fact tables and or apply specific transformations to do some cleaning.
- metadata/types: this sub-directory is a companion to the metadata/load directory. It contains all custom type validation you wish to apply on records loaded from a file. You may want that a record has a specific length or verify a specific pattern like an email for example. This allows to go much further than simply checking the input against standard python or java types.
- metadata/connections.sl.yml: This file contains all the connections to your datawarehouse. Note , you may that usually you just have one connection
- metadata/refs.sl.yml: In your SQL transforms, you may be joining tables coming from different domains or databases. In that case, you normally need to reference your table by its full name such as: `project-id.domain.my-table`. The refs file allows to make your query more readable by allowing to map the name `my-table` to its full name.
- metadata/env.[SL_ENV].sl.yml: You may use any of the variables defined in the env files in your extract, load and transforms jobs. The SL_ENV env var activates a specific env file making it possible to assign to variables, values based on the active environment.


## Domains

Whether you load files or apply operations on tables, your load and transform jobs will end up writing to a table hosted in a domain.

A domain is a synonym to :
- a schema in some databases such as Postgres or Snowflake
- a database in Databricks
- A dataset in BigQuery.

Since tables are necessarily hosted in a domain, Starlake need to create a domain if it does not exist before it stores the data into the table.
The domain name is specified by the folder name where the table is defined. For example, if you have a table defined in the following path: `metadata/transform/my-domain/my-table.sl.yml`, then the domain name will be `my-domain`.

:::note

You may still overload the domain name in the file `metadata/transform/my-domain/_config.sl.yml` by specifying a different domain name in the `name` property.

:::


## Tables

Any load or transform job that will end up writing to a table `my-table` in the domain `my-domain` is defined in the file `metadata/load/my-domain/my-table.sl.yml` for load jobs
and in the file `metadata/transform/my-domain/my-table.sl.yml` for transform jobs.

:::note

You may still overload the table name in the file `my-table.sl.yml` by specifying a different table name in the `name` property.

:::

## Connections

Connections are defined in the file `metadata/connections.sl.yml`. This file contains a list of connections.
Each connection has a name and a type.
- The type is the type of the database you want to connect to: JDBC, BigQuery, Databricks, Spark, Hive, Filesystem ect ...
- The name is the name you will use to reference the connection in your load and transform jobs.

## Environments

Environments are defined in the file `metadata/env.[SL_ENV].sl.yml`. This file contains a list of variables.
Each variable has a name and a value.
- The name is the name you will use to reference the variable in your jobs using the syntax `{{variable}}` or `${variable}`.
- The value is the value of the variable.

Your may assign a value to a variable based on the active environment. For example, you may want to use a different database name based on the environment you are running your job in.
the file metadata/env.sl.yml is always loaded then, il the SL_ENV variable is defined, the file metadata/env.[SL_ENV].sl.yml is also loaded and values defined in this file will override the values defined in the file metadata/env.sl.yml.


## Refs

Refs are used essentially in SQL transform jobs. They allow to reference a table by its name instead of its full name.

For example, if you have a table `my-table` in the domain `my-domain`, you may reference it in your SQL query by using the syntax `my-table` instead of `my-domain.my-table` or `my-database.my-domain.my-table`.

Refs are also useful to implicitly reference a table in a different domain or database based on the environment your job is running in: DEV or PROD for example.
