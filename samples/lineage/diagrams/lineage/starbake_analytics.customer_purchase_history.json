{"taskName":"starbake_analytics.customer_purchase_history","json":"{\n  \"tables\" : [ {\n    \"domain\" : \"starbake_analytics\",\n    \"table\" : \"customer_purchase_history\",\n    \"columns\" : [ \"customer_id\", \"customer_name\", \"email\", \"total_orders\", \"total_spent\", \"first_order_date\", \"last_order_date\", \"purchased_categories\", \"days_since_first_order\" ],\n    \"isTask\" : false\n  }, {\n    \"domain\" : \"starbake\",\n    \"table\" : \"customers\",\n    \"columns\" : [ \"first_name\", \"last_name\", \"email\", \"id\", \"join_date\" ],\n    \"isTask\" : false\n  }, {\n    \"domain\" : \"starbake\",\n    \"table\" : \"orders\",\n    \"columns\" : [ \"customer_id\", \"order_date\", \"order_id\", \"product_id\", \"quantity\" ],\n    \"isTask\" : false\n  }, {\n    \"table\" : \"co\",\n    \"columns\" : [ \"customer_id\", \"total_orders\", \"total_spent\", \"first_order_date\", \"last_order_date\", \"purchased_categories\" ],\n    \"isTask\" : false\n  } ],\n  \"relations\" : [ {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"customer_id\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"customer_id\"\n    },\n    \"expression\" : \"customer_id\"\n  }, {\n    \"from\" : {\n      \"domain\" : \"starbake\",\n      \"table\" : \"orders\",\n      \"column\" : \"customer_id\"\n    },\n    \"to\" : {\n      \"table\" : \"co\",\n      \"column\" : \"customer_id\"\n    },\n    \"expression\" : \"customer_id\"\n  }, {\n    \"from\" : {\n      \"domain\" : \"starbake\",\n      \"table\" : \"customers\",\n      \"column\" : \"first_name\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"customer_name\"\n    },\n    \"expression\" : \"concat(c.first_name, ' ', c.last_name)\"\n  }, {\n    \"from\" : {\n      \"domain\" : \"starbake\",\n      \"table\" : \"customers\",\n      \"column\" : \"last_name\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"customer_name\"\n    },\n    \"expression\" : \"concat(c.first_name, ' ', c.last_name)\"\n  }, {\n    \"from\" : {\n      \"domain\" : \"starbake\",\n      \"table\" : \"customers\",\n      \"column\" : \"email\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"email\"\n    },\n    \"expression\" : \"email\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"total_orders\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"total_orders\"\n    },\n    \"expression\" : \"total_orders\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"total_spent\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"total_spent\"\n    },\n    \"expression\" : \"total_spent\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"first_order_date\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"first_order_date\"\n    },\n    \"expression\" : \"first_order_date\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"last_order_date\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"last_order_date\"\n    },\n    \"expression\" : \"last_order_date\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"purchased_categories\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"purchased_categories\"\n    },\n    \"expression\" : \"purchased_categories\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"first_order_date\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"days_since_first_order\"\n    },\n    \"expression\" : \"DATEDIFF('day', co.first_order_date, co.last_order_date)\"\n  }, {\n    \"from\" : {\n      \"table\" : \"co\",\n      \"column\" : \"last_order_date\"\n    },\n    \"to\" : {\n      \"domain\" : \"starbake_analytics\",\n      \"table\" : \"customer_purchase_history\",\n      \"column\" : \"days_since_first_order\"\n    },\n    \"expression\" : \"DATEDIFF('day', co.first_order_date, co.last_order_date)\"\n  } ]\n}"}